{% extends 'workflow/base.html' %}
{% block title %}Yeni Workflow{% endblock %}

{% block content %}
<style>
/* workflow-glass.css */
/* === CREATE – Minimal Stepper + Soft Gradient (yalnızca CSS) === */

/* Arka planı hafif degrade yapalım */
body {
  background: linear-gradient(135deg, #eef2ff 0%, #f8fafc 60%, #ffffff 100%);
}

/* Kartı daha düz, kenarlı ve profesyonel hale getirelim */
.card {
  background: #ffffff !important;
  border: 1px solid rgba(15,23,42,.08) !important;
  border-radius: 14px !important;
  box-shadow: 0 8px 24px rgba(2,6,23,.06) !important;
  padding: 1.75rem !important;
  transition: box-shadow .2s ease, transform .2s ease !important;
}
.card:hover { box-shadow: 0 14px 40px rgba(2,6,23,.10) !important; }

/* Fieldset'leri “adım” gibi göstermek için sol şerit ve rozet */
fieldset {
  position: relative;
  background: #ffffff;
  border: 1px solid rgba(15,23,42,.06);
  border-left: 4px solid rgba(79,70,229,.9); /* indigo şerit */
  border-radius: 12px;
  padding: 1.1rem 1.2rem 1rem 1.2rem;
}

/* Legend – rozeti ve başlığı belirginleştirelim */
legend {
  display: inline-flex;
  align-items: center;
  gap: .5rem;
  padding: .2rem .6rem;
  background: #fff;
  border: 1px solid rgba(15,23,42,.06);
  border-radius: 999px;
  font-weight: 600;
  font-size: .92rem;
  color: #111827;
}
.row.g-4 > .col-md-6:first-child legend::before {
  content: "1";
  display: inline-grid;
  place-items: center;
  width: 1.35rem; height: 1.35rem;
  border-radius: 50%;
  background: rgba(79,70,229,1);
  color: #fff; font-size: .8rem; font-weight: 700;
}
.row.g-4 > .col-md-6:last-child legend::before {
  content: "2";
  display: inline-grid;
  place-items: center;
  width: 1.35rem; height: 1.35rem;
  border-radius: 50%;
  background: #f59e0b; /* amber */
  color: #111827; font-size: .8rem; font-weight: 800;
}

/* Etiketler */
.card form label {
  font-weight: 600;
  font-size: .9rem;
  color: #334155;
  margin-bottom: .35rem;
}

/* — INPUT TARZI: “Underline + Soft Glow” — */
input.form-control,
select.form-select,
textarea.form-control,
input[type="text"], input[type="email"], input[type="number"],
input[type="password"], textarea, select {
  background: transparent;
  border: none;
  border-bottom: 2px solid #e5e7eb !important;
  border-radius: 0 !important;
  padding: .55rem 0 !important;
  box-shadow: none !important;
  transition: border-color .2s ease, box-shadow .2s ease, background .2s ease;
}
input::placeholder, textarea::placeholder { color: #9aa4b2; }

input:focus, select:focus, textarea:focus,
.form-control:focus, .form-select:focus {
  outline: none !important;
  border-bottom-color: #4f46e5 !important; /* indigo */
  box-shadow: 0 6px 18px -10px rgba(79,70,229,.55);
  background: transparent;
}

/* Select okunu sadeleştir (underline tarzıyla uyumlu) */
select.form-select {
  background-image: none !important;
  padding-right: 1.6rem !important;
}

/* Checkbox / radio renk uyumu */
input[type="checkbox"], input[type="radio"] {
  accent-color: #4f46e5;
}

/* — DOSYA YÜKLEME: “Dropzone-look” sadece CSS — */
input[type="file"].form-control,
input[type="file"] {
  border: 2px dashed #d1d5db !important;
  border-radius: 12px !important;
  padding: .9rem 1rem !important;
  background: #f8fafc;
  transition: border-color .2s ease, background .2s ease;
  cursor: pointer;
}
input[type="file"]:hover {
  border-color: #4f46e5 !important;
  background: #f1f5f9;
}
input[type="file"]::-webkit-file-upload-button,
input[type="file"]::file-selector-button {
  font: inherit;
  border: none;
  border-radius: 10px;
  padding: .6rem .95rem;
  background: #4f46e5;
  color: #fff;
  box-shadow: 0 6px 20px rgba(79,70,229,.25);
  transition: transform .15s ease, box-shadow .2s ease, opacity .15s ease;
  cursor: pointer;
  margin-right: .8rem;
}
input[type="file"]::-webkit-file-upload-button:hover,
input[type="file"]::file-selector-button:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 26px rgba(79,70,229,.35);
}

/* — BUTONLAR — */
/* Birincil: büyük, kapsül form, gradient */
.btn-primary {
  border: none !important;
  border-radius: 999px !important;
  padding: .95rem 1.8rem !important;
  font-weight: 700 !important;
  letter-spacing: .2px;
  background-image: linear-gradient(90deg, #4f46e5, #06b6d4) !important;
  color: #fff !important;
  box-shadow: 0 14px 28px rgba(6,182,212,.25);
  transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
}
.btn-primary:hover { transform: translateY(-1px); box-shadow: 0 18px 40px rgba(6,182,212,.32); }
.btn-primary:active { transform: translateY(0); }

/* İkincil buton: ince çerçeve, kapsül */
.btn-outline-secondary {
  border-radius: 999px !important;
  border-color: #cbd5e1 !important;
  color: #334155 !important;
  background: #fff !important;
}
.btn-outline-secondary:hover {
  background: #f1f5f9 !important; border-color: #94a3b8 !important; color: #0f172a !important;
}

/* Form paragrafları aralığı */
.card form p { margin-bottom: 1rem; }

/* Responsive: mobilde card iç boşluğu ve buton genişliği */
@media (max-width: 768px) {
  .card { padding: 1.25rem !important; }
  .btn-lg { width: 100%; }
}

/* Navbar link hover (uyumlu kalsın) */
.navbar .nav-link:hover {
  background-color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity,1));
  color: #fff !important;
  border-radius: 8px;
}
/* === Fixes: responsive taşma + büyük legend + belirgin textbox === */

/* 1) Legend'ları büyüt ve akışkan yap */
legend {
  font-size: clamp(1rem, 1.1vw + .7rem, 1.25rem) !important;
  font-weight: 700 !important;
  padding: .25rem .75rem !important;
}
.row.g-4 > .col-md-6:first-child legend::before,
.row.g-4 > .col-md-6:last-child legend::before {
  width: 1.6rem; height: 1.6rem;
  font-size: .9rem;
}

/* 2) Input'ları “textbox” görünümüne çevir (underline'ı geçersiz kıl) */
input.form-control,
select.form-select,
textarea.form-control,
input[type="text"], input[type="email"], input[type="number"],
input[type="password"], textarea, select {
  background: #fff !important;
  border: 1.5px solid #cfd8e3 !important;
  border-radius: 10px !important;
  padding: .7rem .85rem !important;
  box-shadow: 0 1px 0 rgba(2,6,23,.03) inset !important;
}
input:focus, select:focus, textarea:focus,
.form-control:focus, .form-select:focus {
  border-color: #4f46e5 !important;
  box-shadow: 0 0 0 .25rem rgba(79,70,229,.18) !important;
  background: #fff !important;
}

/* Placeholder daha görünür */
input::placeholder, textarea::placeholder { color: #8a94a6 !important; }

/* 3) File input: tam genişlik + taşma koruması */
input[type="file"].form-control,
input[type="file"] {
  width: 100% !important;
  box-sizing: border-box;
  min-height: 3.25rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
input[type="file"]::-webkit-file-upload-button,
input[type="file"]::file-selector-button {
  padding: .65rem 1rem !important;
}

/* 4) Fieldset iç boşluklarını mobilde sıkıştır, taşmayı önle */
fieldset {
  padding: 1rem 1rem 0.9rem 1rem !important;
}
.card form p { margin-bottom: .9rem !important; }

/* 5) Grid ve buton mobil davranışı */
@media (max-width: 992px) {
  .row.g-4 { row-gap: 1.25rem !important; }
  .card { padding: 1.25rem !important; }
  fieldset { margin-bottom: .25rem; }
  .btn-lg { width: 100%; }               /* Başlat butonu taşma yapmasın */
}

/* 6) Küçük ekranlarda başlık/legend satır kırılmasın, taşma olmasın */
legend, label {
  line-height: 1.25;
  word-break: break-word;
}

/* 7) Sayfanın yatay taşmasını tamamen engelle */
html, body { overflow-x: hidden; }

/* 8) Sağ kolondaki uzun satır çizgilerinin (underline) kalktığından emin ol */
.col-md-6 p { max-width: 100%; }
/* File input'ı üstteki textbox ile hizala ve metni kısalt */
input[type="file"].form-control,
input[type="file"] {
  display: block;
  width: 250px !important; /* Name textbox ile aynı genişlik */
  max-width: 100%;
  border: 2px dashed #d1d5db !important;
  border-radius: 10px !important;
  padding: .45rem .5rem !important;
  background: #f8fafc;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

/* İç buton ve metin hizalaması */
input[type="file"]::-webkit-file-upload-button,
input[type="file"]::file-selector-button {
  padding: .5rem .8rem !important;
  margin-right: .6rem;
  background: #4f46e5;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

/* "Dosya seçilmedi" kısmını taşırmadan kısalt */
input[type="file"]::-webkit-file-upload-button + span,
input[type="file"]::file-selector-button + span {
  max-width: calc(100% - 90px);
  display: inline-block;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: middle;
}


</style>
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">Yeni Workflow Oluştur</h1>
    <a href="{% url 'workflow:list' %}" class="btn btn-outline-secondary">
      Tüm Workflow’lar
    </a>
  </div>

  <form method="post" enctype="multipart/form-data" class="card shadow-sm border-0 p-4">
    {% csrf_token %}
    <div class="row g-4">
      <div class="col-md-6">
        <fieldset class="border rounded p-3 h-100">
          <legend class="w-auto px-2 bg-white">Veri Yükleme</legend>
          {{ upload_form.as_p }}
        </fieldset>
      </div>
      <div class="col-md-6">
        <fieldset class="border rounded p-3 h-100">
          <legend class="w-auto px-2 bg-white">Model & Hiperparametre Seçimi</legend>
          {{ config_form.as_p }}
        </fieldset>
      </div>
    </div>

    <div class="d-flex justify-content-center mt-4">
      <button type="submit" class="btn btn-lg btn-primary px-5">
        Eğitimi Başlat
      </button>
    </div>
  </form>
{% endblock %}
